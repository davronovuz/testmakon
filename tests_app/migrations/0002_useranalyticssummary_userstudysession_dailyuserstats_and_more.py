# Generated by Django 5.2.10 on 2026-01-27 18:36

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('tests_app', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='UserAnalyticsSummary',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('total_study_time', models.PositiveIntegerField(default=0, verbose_name="Jami o'qish vaqti (soat)")),
                ('total_questions_solved', models.PositiveIntegerField(default=0, verbose_name='Jami savollar')),
                ('total_tests_completed', models.PositiveIntegerField(default=0, verbose_name='Jami testlar')),
                ('overall_accuracy', models.FloatField(default=0, verbose_name='Umumiy aniqlik (%)')),
                ('avg_session_duration', models.PositiveIntegerField(default=0, verbose_name="O'rtacha sessiya (daqiqa)")),
                ('avg_questions_per_day', models.FloatField(default=0, verbose_name='Kunlik savollar')),
                ('best_study_hours', models.JSONField(blank=True, default=list, verbose_name='Eng yaxshi soatlar')),
                ('best_study_days', models.JSONField(blank=True, default=list, verbose_name='Eng yaxshi kunlar')),
                ('weak_topics_count', models.PositiveIntegerField(default=0, verbose_name='Kuchsiz mavzular')),
                ('strong_topics_count', models.PositiveIntegerField(default=0, verbose_name='Kuchli mavzular')),
                ('mastered_topics_count', models.PositiveIntegerField(default=0, verbose_name="O'zlashtirilgan")),
                ('predicted_dtm_score', models.PositiveIntegerField(default=0, verbose_name='Bashorat DTM ball')),
                ('university_match_count', models.PositiveIntegerField(default=0, verbose_name='Mos universitetlar')),
                ('current_streak', models.PositiveIntegerField(default=0, verbose_name='Joriy streak')),
                ('longest_streak', models.PositiveIntegerField(default=0, verbose_name='Eng uzun streak')),
                ('learning_style', models.CharField(choices=[('visual', 'Vizual'), ('reading', "O'qish"), ('practice', 'Amaliy'), ('mixed', 'Aralash')], default='mixed', max_length=20, verbose_name="O'qish uslubi")),
                ('avg_fatigue_time', models.PositiveIntegerField(default=45, verbose_name='Charchash vaqti (daqiqa)')),
                ('last_calculated', models.DateTimeField(auto_now=True, verbose_name='Oxirgi hisoblash')),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='analytics_summary', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Analytics xulosa',
                'verbose_name_plural': 'Analytics xulosalar',
            },
        ),
        migrations.CreateModel(
            name='UserStudySession',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('started_at', models.DateTimeField(auto_now_add=True, verbose_name='Boshlangan')),
                ('ended_at', models.DateTimeField(blank=True, null=True, verbose_name='Tugagan')),
                ('duration', models.PositiveIntegerField(default=0, verbose_name='Davomiyligi (soniya)')),
                ('tests_taken', models.PositiveIntegerField(default=0, verbose_name='Testlar')),
                ('questions_answered', models.PositiveIntegerField(default=0, verbose_name='Savollar')),
                ('correct_answers', models.PositiveIntegerField(default=0, verbose_name="To'g'ri")),
                ('device_type', models.CharField(default='unknown', max_length=20, verbose_name='Qurilma')),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True, verbose_name='IP')),
                ('user_agent', models.TextField(blank=True, verbose_name='User Agent')),
                ('is_active', models.BooleanField(default=True, verbose_name='Faol')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='study_sessions', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': "O'qish sessiyasi",
                'verbose_name_plural': "O'qish sessiyalari",
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='DailyUserStats',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateField(verbose_name='Sana')),
                ('tests_taken', models.PositiveIntegerField(default=0, verbose_name='Testlar soni')),
                ('questions_answered', models.PositiveIntegerField(default=0, verbose_name='Javob berilgan')),
                ('correct_answers', models.PositiveIntegerField(default=0, verbose_name="To'g'ri")),
                ('wrong_answers', models.PositiveIntegerField(default=0, verbose_name="Noto'g'ri")),
                ('total_time_spent', models.PositiveIntegerField(default=0, verbose_name='Sarflangan vaqt (soniya)')),
                ('sessions_count', models.PositiveIntegerField(default=0, verbose_name='Sessiyalar')),
                ('xp_earned', models.PositiveIntegerField(default=0, verbose_name='Olingan XP')),
                ('most_active_hour', models.PositiveIntegerField(blank=True, null=True, verbose_name='Eng faol soat')),
                ('activity_hours', models.JSONField(blank=True, default=dict, verbose_name='Faollik soatlari')),
                ('subjects_practiced', models.JSONField(blank=True, default=dict, verbose_name='Fanlar')),
                ('accuracy_rate', models.FloatField(default=0, verbose_name='Aniqlik (%)')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='daily_stats', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Kunlik statistika',
                'verbose_name_plural': 'Kunlik statistikalar',
                'ordering': ['-date'],
                'unique_together': {('user', 'date')},
            },
        ),
        migrations.CreateModel(
            name='UserActivityLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('action', models.CharField(choices=[('login', 'Kirish'), ('logout', 'Chiqish'), ('test_start', 'Test boshlash'), ('test_complete', 'Test yakunlash'), ('question_answer', 'Savolga javob'), ('page_view', "Sahifa ko'rish"), ('ai_chat', 'AI suhbat'), ('competition_join', "Musobaqaga qo'shilish"), ('battle_start', 'Jang boshlash'), ('profile_update', 'Profil yangilash'), ('achievement_earn', 'Yutuqqa erishish')], max_length=30, verbose_name='Harakat')),
                ('details', models.JSONField(blank=True, default=dict, verbose_name='Tafsilotlar')),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('device_type', models.CharField(default='unknown', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('subject', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='tests_app.subject')),
                ('topic', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='tests_app.topic')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='activity_logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Faoliyat logi',
                'verbose_name_plural': 'Faoliyat loglari',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['user', 'action'], name='tests_app_u_user_id_942fb3_idx'), models.Index(fields=['user', 'created_at'], name='tests_app_u_user_id_1245c4_idx'), models.Index(fields=['created_at'], name='tests_app_u_created_822bd9_idx')],
            },
        ),
        migrations.CreateModel(
            name='UserSubjectPerformance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('total_tests', models.PositiveIntegerField(default=0, verbose_name='Jami testlar')),
                ('total_questions', models.PositiveIntegerField(default=0, verbose_name='Jami savollar')),
                ('correct_answers', models.PositiveIntegerField(default=0, verbose_name="To'g'ri javoblar")),
                ('average_score', models.FloatField(default=0, verbose_name="O'rtacha ball (%)")),
                ('best_score', models.FloatField(default=0, verbose_name='Eng yaxshi ball (%)')),
                ('last_score', models.FloatField(default=0, verbose_name='Oxirgi ball (%)')),
                ('total_time_spent', models.PositiveIntegerField(default=0, verbose_name='Jami vaqt (soniya)')),
                ('subject_rank', models.PositiveIntegerField(blank=True, null=True, verbose_name='Fan reytingi')),
                ('predicted_dtm_score', models.FloatField(default=0, verbose_name='Bashorat DTM ball')),
                ('last_practiced', models.DateTimeField(blank=True, null=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('subject', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='user_subject_performances', to='tests_app.subject')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='subject_performances', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Fan natijasi',
                'verbose_name_plural': 'Fan natijalari',
                'unique_together': {('user', 'subject')},
            },
        ),
        migrations.CreateModel(
            name='UserTopicPerformance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('total_questions', models.PositiveIntegerField(default=0, verbose_name='Jami savollar')),
                ('correct_answers', models.PositiveIntegerField(default=0, verbose_name="To'g'ri javoblar")),
                ('wrong_answers', models.PositiveIntegerField(default=0, verbose_name="Noto'g'ri javoblar")),
                ('total_time_spent', models.PositiveIntegerField(default=0, verbose_name='Jami vaqt (soniya)')),
                ('avg_time_per_question', models.FloatField(default=0, verbose_name="O'rtacha vaqt")),
                ('current_score', models.FloatField(default=0, verbose_name='Joriy ball (%)')),
                ('best_score', models.FloatField(default=0, verbose_name='Eng yaxshi ball (%)')),
                ('score_trend', models.CharField(choices=[('improving', 'Yaxshilanmoqda'), ('stable', 'Barqaror'), ('declining', 'Pasaymoqda')], default='stable', max_length=20, verbose_name='Trend')),
                ('is_weak', models.BooleanField(default=False, verbose_name='Kuchsiz mavzu')),
                ('is_strong', models.BooleanField(default=False, verbose_name='Kuchli mavzu')),
                ('is_mastered', models.BooleanField(default=False, verbose_name="O'zlashtirilgan")),
                ('last_practiced', models.DateTimeField(blank=True, null=True, verbose_name='Oxirgi mashq')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('subject', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='user_performances', to='tests_app.subject')),
                ('topic', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='user_performances', to='tests_app.topic')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='topic_performances', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Mavzu natijasi',
                'verbose_name_plural': 'Mavzu natijalari',
                'ordering': ['current_score'],
                'unique_together': {('user', 'topic')},
            },
        ),
    ]
